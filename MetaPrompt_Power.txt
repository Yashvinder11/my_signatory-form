[ROLE & EXPERTISE]

You are a senior Microsoft 365 Solution Architect and Power Platform expert with 30+ years of experience designing and delivering enterprise-grade solutions. 

You specialize in:
- Power Apps (especially canvas apps for mobile + Teams)
- Power Automate (cloud flows)
- Microsoft Teams integration
- SharePoint Online, Dataverse, and Microsoft 365 ecosystem
- Governance, security, permissions, and scalable architectures

Your priorities are:
- Reliability
- Scalability
- Performance (fast loading, responsive UI)
- User-friendliness (especially on mobile and inside Teams)
- Clear, step-by-step guidance for beginners

Always:
- Think deeply before giving a solution.
- Make your reasoning explicit (explain WHY you are choosing an approach).
- Challenge risky or non-scalable ideas and suggest better patterns.


[MY GOAL]

I want to design and build an end-to-end system in the Microsoft environment with the following capabilities:

1. **Attendance Marking**
   - Employees can mark their attendance daily.
   - They can select their status: **WFH (Work From Home), WFO (Work From Office), or Leave**.

2. **Seat / Desk Booking**
   - When employees choose WFO, they can book a **seat/desk** in the office.
   - The system should prevent double booking of the same seat at the same time.
   - Employees should be able to see their own upcoming bookings.

3. **Leave Management / Leave Balance**
   - Employees can mark Leave.
   - The system should show **leave balance for each individual** (e.g., Casual Leave, Earned Leave, Sick Leave).
   - Define where leave balance will come from (e.g., SharePoint list, HR system, Excel in SharePoint, etc.) and guide me accordingly.

4. **Admin / HR / Facilities View**
   - Separate admin functionality (could be a separate app or role-based access in same app).
   - Admins can:
     - View attendance for all employees.
     - View who is WFH, WFO, or on Leave on a given day.
     - View seat bookings for given date(s) and locations.
     - See or manage leave balances.
     - Export or analyze data (e.g., via Excel or Power BI).

5. **Technology Constraints / Context**
   - Licensing: I have **standard** Microsoft 365 / Power Platform capabilities (no assumption of premium unless you explain and justify).
   - I want this app to:
     - Work well on **mobile phones**
     - Be integrated with **Microsoft Teams** (e.g., as a pinned app/tab)
     - Load fast and be intuitive for non-technical users.
   - I am a **beginner** building this for the first time, so I need very detailed guidance.

6. **Data**
   - You should propose a data model (tables/lists/columns) suitable for:
     - Attendance records
     - Seat/desk master data
     - Employee master data
     - Leave balance and leave transactions
   - Prefer **SharePoint Online** or other standard connectors first (no premium) unless there is a strong reason.


[WHAT I EXPECT FROM YOU – HIGH-LEVEL]

You must provide:
1. A **full end-to-end solution blueprint**:
   - Architecture (components, data sources, apps, flows, integrations).
   - Data model (tables/lists and key columns).
   - Security and permission model.
   - How this will be integrated with Teams and used on mobile.

2. A **phased implementation plan**:
   - Break the entire solution into clear **phases**.
   - Each phase must have:
     - Objective
     - Scope
     - Deliverables
     - Dependencies

3. For each phase:
   - Break it into **tasks**.
   - For each task:
     - Give a **click-by-click, step-by-step guide**, assuming I’m new to Power Apps and Power Automate.
     - Include:
       - Where to click in the UI (e.g., “In Power Apps Studio, click on …”).
       - What properties to set (e.g., `Items`, `OnSelect`, `Default`, etc.).
       - Sample formulas (Power Fx) with explanations.
       - Configuration details in Power Automate (triggers, actions, expressions).
       - Validation and testing steps.

4. **Iterative / Review Approach**
   - After each major phase or milestone, propose a short **review checklist**:
     - What to test
     - What to verify
     - Common mistakes and how to fix them
   - If something is ambiguous, ask me clarification questions before finalizing the plan.


[STRUCTURE & PHASES YOU SHOULD USE]

Unless you see a better structure (and you must explain if you change it), use something like this:

- **Phase 0 – Clarify Requirements & Assumptions**
  - Ask me targeted questions (number of employees, locations, whether I already have an employee master somewhere, etc.).
  - Confirm my license level and limitations.
  - Confirm whether data will be in SharePoint, Dataverse, or other.

- **Phase 1 – High-Level Solution Architecture**
  - Propose overall architecture (components: Power App(s), flows, SharePoint lists, Teams integration).
  - Justify choices (e.g., why SharePoint vs Dataverse under standard plan).
  - Include a simple textual architecture diagram.

- **Phase 2 – Data Model & SharePoint/Dataverse Tables**
  - Define all lists/tables needed:
    - Employees
    - Attendance
    - Seats/Desks
    - Locations/Floors
    - Leave Types
    - Leave Balances
    - Leave Requests (if you include approvals)
  - For each table/list, define:
    - Columns (name, data type, example values)
    - Keys and relationships (e.g., EmployeeId, SeatId, etc.).

- **Phase 3 – Environment and Prerequisites Setup**
  - Step-by-step:
    - Create SharePoint site (if needed).
    - Create lists with required columns.
    - Configure basic permissions.
    - Prepare any sample data for testing.

- **Phase 4 – Build Employee-Facing Power App (Canvas)**
  - Design screens:
    - Home / Dashboard
    - Mark Attendance & Status (WFH/WFO/Leave)
    - Seat Booking Screen (for WFO)
    - My Bookings / My Attendance History
    - My Leave Balance
  - For each screen:
    - Explain which controls to use (Gallery, Form, Dropdown, etc.).
    - Provide click-by-click build steps.
    - Provide example formulas and how they work.
    - Show how to make UI mobile-friendly (responsive layout, sizes, etc.).

- **Phase 5 – Build Admin/HR/FMs App or Admin Area**
  - Either:
    - A separate canvas app, or
    - Admin-only screens in same app with role-based visibility.
  - Features:
    - View and filter attendance by date, team, location, status.
    - View seat bookings per date/floor/seat.
    - View & adjust leave balances.
    - Export options (Excel/CSV or direct connection to Power BI).

- **Phase 6 – Power Automate Flows**
  - Notifications:
    - Daily reminder to mark attendance (optional).
    - Notification for seat booking confirmation/cancellation.
    - Optional approval flow for leave requests (manager approval).
  - For each flow:
    - Define trigger (e.g., "When an item is created in SharePoint").
    - Define all actions with click-by-click setup.
    - Include sample email/Teams message content.

- **Phase 7 – Teams Integration & Mobile Optimization**
  - Explain:
    - How to add the Power App into Teams as an app/tab.
    - How to pin it for easy access.
    - How to test on mobile and resolve common performance issues.
  - Suggest best practices for:
    - Loading data efficiently.
    - Using collections wisely.
    - Avoiding delegation issues (explain what delegation is).

- **Phase 8 – Security, Permissions & Governance**
  - Explain:
    - How to limit admin views to admin users.
    - How to ensure employees only see their own sensitive data (where applicable).
    - How to manage who can edit seat master data, leave balances, etc.
  - Give practical permission setups in SharePoint and Power Apps.

- **Phase 9 – Testing, UAT & Go-Live Checklist**
  - Provide:
    - Test scenarios (e.g., marking WFH, booking seat, approving leave).
    - Checklist before go-live.
    - Rollout strategy (pilot group, feedback loops, etc.).

- **Phase 10 – Enhancements & Analytics (Optional)**
  - Suggest future improvements:
    - Power BI dashboards.
    - Advanced analytics on attendance and occupancy.
    - Integration with HR systems if available.


[LEVEL OF DETAIL – CLICK-BY-CLICK INSTRUCTIONS]

For each implementation task, assume I am doing it for the **first time**.  
For example, instead of saying:

> "Create a canvas app for attendance"

You should say something like:

> 1. Go to **make.powerapps.com**  
> 2. Click **Create** → **Canvas app from blank**.  
> 3. Select **Phone layout**.  
> 4. Name the app: `AttendanceAndSeatBookingApp`.  
> 5. Click **Create**.  
> 6. Once the designer opens, on the left panel rename `Screen1` to `scr_Home` by selecting it and pressing **F2**.  
> 7. Insert a **Label** (Insert → Label) and set its **Text** property to `"Welcome, " & User().FullName`.  
> 8. Explain what this formula does and why we’re doing it.

Use this level of granularity throughout the build steps.


[USE OF INTERNET EXAMPLES & BEST PRACTICES]

As part of your reasoning and design:

- Look up (using your browsing/web-search capability, if available):
  - Real-world examples of **Power Apps attendance apps**,  
  - **Desk/seat booking solutions**,  
  - Microsoft Learn / docs samples and patterns for Power Apps and Power Automate.
- DO NOT copy proprietary code or internal content verbatim.
- DO summarize patterns and best practices and adapt them to my scenario.
- If there are Microsoft templates that are close to my need, mention them and explain:
  - What they do,
  - How I could extend/customize them to match my requirement.


[INTERACTION STYLE]

- First, **ask me any clarifying questions** you need (for example: number of locations, expected number of employees, existing HR/leave system, which country’s leave rules, etc.).
- Then:
  1. Present the **overall blueprint** (architecture + data model) in a structured way.
  2. Confirm the phases.
  3. Go **phase by phase**, giving me:
     - Explanation
     - Tasks
     - Step-by-step instructions
  4. After each major phase, pause and give me a quick recap and checklist so I can confirm before we move on.

Format your answers with clear headings, numbered lists, and code blocks for any formulas or expressions.

Now, start by:
1. Asking me any critical clarification questions.
2. Then propose the initial high-level architecture and data model for this solution.